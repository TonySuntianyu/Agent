# 项目启动指南

## 📋 项目概述

本项目包含两个核心模块：
1. **LangGraph基础框架** (`Langgraph框架/`) - 通用Agent开发框架
2. **图书推荐Agent** (`agent/`) - 基于LangGraph的智能图书推荐系统

---

## 🚀 快速开始

### 前置要求

- Python 3.8+
- pip 包管理器
- 网络连接（用于下载依赖和API调用）

### 第一步：安装依赖

#### 1.1 安装LangGraph框架依赖

```bash
cd Langgraph框架
pip install -r requirements.txt
```

#### 1.2 安装图书推荐Agent依赖

```bash
cd ../agent
pip install -r requirements.txt
```

**或者一次性安装所有依赖**：

```bash
# 在项目根目录执行
pip install -r Langgraph框架/requirements.txt
pip install -r agent/requirements.txt
```

---

## ⚙️ 第二步：配置环境变量

### 方式1：使用环境变量（推荐）

#### Windows (PowerShell)
```powershell
$env:OPENAI_API_KEY = "your_openai_api_key_here"
$env:DEEPSEEK_API_KEY = "your_deepseek_api_key_here"
$env:AGENT_MODEL = "deepseek-chat"
$env:DEEPSEEK_BASE_URL = "https://api.deepseek.com"
```

#### Linux/Mac
```bash
export OPENAI_API_KEY="your_openai_api_key_here"
export DEEPSEEK_API_KEY="your_deepseek_api_key_here"
export AGENT_MODEL="deepseek-chat"
export DEEPSEEK_BASE_URL="https://api.deepseek.com"
```

### 方式2：创建.env文件

在项目根目录或相应子目录创建 `.env` 文件：

```env
# OpenAI配置
OPENAI_API_KEY=your_openai_api_key_here

# DeepSeek配置（推荐，免费）
DEEPSEEK_API_KEY=your_deepseek_api_key_here
AGENT_MODEL=deepseek-chat
DEEPSEEK_BASE_URL=https://api.deepseek.com
TEMPERATURE=0.7

# Gemini配置（可选）
GEMINI_API_KEY=your_gemini_api_key_here
```

### 方式3：修改配置文件

编辑 `agent/config.py` 或 `Langgraph框架/config.py` 直接设置API密钥。

---

## 🎯 第三步：选择启动方式

### 方式A：启动LangGraph基础框架

#### 交互式命令行模式

```bash
cd Langgraph框架
python run.py
```

**功能**：
- 支持多种工具（计算器、文件操作、数据分析等）
- 交互式对话
- 智能工具调用

**使用示例**：
```
您: 计算 2^10 + 3*5 的结果
Agent: 1024 + 15 = 1039

您: 列出当前目录的文件
Agent: [列出文件列表]
```

#### 运行示例代码

```bash
cd Langgraph框架
python example.py
```

#### 运行测试

```bash
cd Langgraph框架
python test_agent.py
```

---

### 方式B：启动图书推荐Agent

#### B1. Web界面模式（推荐）⭐

```bash
cd agent
python app.py
```

然后在浏览器中访问：
```
http://localhost:5000
```

**功能**：
- 现代化的Web聊天界面
- 实时图书搜索和推荐
- 用户友好的交互体验

**界面特性**：
- 📱 响应式设计
- 💬 实时消息显示
- 🎨 美观的UI界面

#### B2. 命令行交互模式

```bash
cd agent
python book_run.py
```

**功能**：
- 交互式图书推荐
- 支持多种查询方式
- 详细的推荐理由

**使用示例**：
```
您: 搜索《三体》
Agent: 找到了《三体》的详细信息...

您: 我看了《三体》，推荐相似图书
Agent: 基于《三体》，我推荐以下图书：
      - 《流浪地球》（同作者）
      - 《球状闪电》（同作者）
      - 《1984》（相似类型）
```

#### B3. 使用启动脚本

```bash
cd agent
python start_agent.py
```

#### B4. 运行示例代码

```bash
cd agent
python book_example.py
```

#### B5. 运行测试

```bash
cd agent
python book_test.py
```

---

## 📊 启动方式对比

| 启动方式 | 适用场景 | 优点 | 缺点 |
|---------|---------|------|------|
| **Web界面** | 日常使用、演示 | 界面友好、易于使用 | 需要浏览器 |
| **命令行交互** | 开发调试、脚本调用 | 灵活、可编程 | 需要命令行操作 |
| **示例代码** | 学习参考 | 代码清晰、易理解 | 功能有限 |
| **测试脚本** | 功能验证 | 自动化测试 | 仅用于测试 |

---

## 🔧 详细配置说明

### LangGraph框架配置

**配置文件**: `Langgraph框架/config.py`

```python
OPENAI_API_KEY = os.getenv("OPENAI_API_KEY")
AGENT_MODEL = os.getenv("AGENT_MODEL", "gpt-4")
TEMPERATURE = float(os.getenv("TEMPERATURE", "0.7"))
MAX_ITERATIONS = int(os.getenv("MAX_ITERATIONS", "10"))
```

### 图书推荐Agent配置

**配置文件**: `agent/config.py`

```python
DEEPSEEK_API_KEY = os.getenv("DEEPSEEK_API_KEY")
AGENT_MODEL = os.getenv("AGENT_MODEL", "deepseek-chat")
TEMPERATURE = float(os.getenv("TEMPERATURE", "0.7"))
DEEPSEEK_BASE_URL = os.getenv("DEEPSEEK_BASE_URL", "https://api.deepseek.com")
```

---

## 🐛 常见问题排查

### 问题1: 模块导入错误

**错误信息**: `ModuleNotFoundError: No module named 'xxx'`

**解决方案**:
```bash
pip install -r requirements.txt
```

### 问题2: API密钥错误

**错误信息**: `请设置API密钥环境变量`

**解决方案**:
1. 检查环境变量是否设置
2. 确认API密钥是否正确
3. 验证API密钥是否有效

### 问题3: 端口被占用

**错误信息**: `Address already in use`

**解决方案**:
```bash
# 查找占用端口的进程
# Windows
netstat -ano | findstr :5000

# Linux/Mac
lsof -i :5000

# 修改端口（编辑app.py）
app.run(debug=True, port=8080)
```

### 问题4: 前端无法连接后端

**错误信息**: `Failed to fetch` 或 `Connection refused`

**解决方案**:
1. 确认后端服务器正在运行
2. 检查 `script.js` 中的 `API_URL` 是否正确
3. 确认CORS已启用
4. 检查防火墙设置

### 问题5: 路径编码问题

**错误信息**: 路径包含中文导致无法运行

**解决方案**:
- 使用英文路径
- 或使用Python的 `runpy` 模块
- 或使用绝对路径

---

## 📝 启动检查清单

在启动项目前，请确认：

- [ ] Python 3.8+ 已安装
- [ ] 所有依赖包已安装 (`pip install -r requirements.txt`)
- [ ] API密钥已配置（OpenAI/DeepSeek/Gemini）
- [ ] 环境变量已设置或配置文件已修改
- [ ] 网络连接正常
- [ ] 端口5000未被占用（Web模式）

---

## 🎯 推荐启动流程

### 首次使用

1. **安装依赖**
   ```bash
   pip install -r Langgraph框架/requirements.txt
   pip install -r agent/requirements.txt
   ```

2. **配置API密钥**
   ```bash
   # 设置环境变量或修改配置文件
   export DEEPSEEK_API_KEY="your_key"
   ```

3. **启动Web界面**（推荐）
   ```bash
   cd agent
   python app.py
   ```

4. **访问界面**
   ```
   http://localhost:5000
   ```

### 日常使用

**Web模式**（最简单）:
```bash
cd agent && python app.py
```

**命令行模式**（更灵活）:
```bash
cd agent && python book_run.py
```

---

## 🔍 验证启动成功

### Web模式验证

1. 启动 `python app.py`
2. 看到输出：`Running on http://127.0.0.1:5000`
3. 浏览器访问 `http://localhost:5000`
4. 看到聊天界面

### 命令行模式验证

1. 启动 `python book_run.py`
2. 看到欢迎信息
3. 输入测试消息
4. 收到Agent回复

---

## 📚 相关文档

- [README.md](README.md) - 项目总体说明
- [项目说明.md](项目说明.md) - 详细项目文档
- [agent/前端启动指南.md](agent/前端启动指南.md) - 前端详细指南
- [agent/BOOK_README.md](agent/BOOK_README.md) - 图书推荐系统文档
- [Langgraph框架/README.md](Langgraph框架/README.md) - 框架文档

---

## 💡 使用技巧

### 1. 同时运行多个服务

如果需要同时运行多个服务，可以修改端口：

```python
# 在app.py中
app.run(debug=True, port=5001)
```

### 2. 后台运行

**Linux/Mac**:
```bash
nohup python app.py > app.log 2>&1 &
```

**Windows**:
使用任务计划程序或启动为服务

### 3. 使用虚拟环境（推荐）

```bash
# 创建虚拟环境
python -m venv venv

# 激活虚拟环境
# Windows
venv\Scripts\activate
# Linux/Mac
source venv/bin/activate

# 安装依赖
pip install -r requirements.txt
```

---

## 🎉 开始使用

现在你已经了解了如何启动项目，选择最适合你的方式开始使用吧！

**推荐新手**: 使用Web界面模式（`python app.py`）  
**推荐开发者**: 使用命令行模式（`python book_run.py`）  
**推荐学习**: 查看示例代码（`python example.py`）

---

**最后更新**: 2024年12月  
**项目版本**: 1.0.0

