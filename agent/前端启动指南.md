# å‰ç«¯å¯åŠ¨æŒ‡å—

## ğŸ“‹ æ¦‚è¿°

æœ¬é¡¹ç›®çš„å‰ç«¯æ˜¯ä¸€ä¸ªåŸºäºFlaskçš„Webåº”ç”¨ï¼ŒåŒ…å«ï¼š
- **åç«¯**: Flask APIæœåŠ¡å™¨ï¼ˆæä¾›RESTful APIï¼‰
- **å‰ç«¯**: HTML + CSS + JavaScriptï¼ˆé™æ€æ–‡ä»¶ï¼‰

## ğŸš€ å¿«é€Ÿå¯åŠ¨

### æ–¹æ³•1: ä½¿ç”¨Flaskå†…ç½®æœåŠ¡å™¨ï¼ˆæ¨èï¼‰

#### æ­¥éª¤1: å®‰è£…ä¾èµ–

```bash
cd agent
pip install -r requirements.txt
```

ç¡®ä¿å·²å®‰è£…ä»¥ä¸‹å…³é”®ä¾èµ–ï¼š
- Flask >= 2.0.0
- Flask-Cors >= 3.0.0
- å…¶ä»–Agentç›¸å…³ä¾èµ–

#### æ­¥éª¤2: é…ç½®ç¯å¢ƒå˜é‡

ç¡®ä¿å·²è®¾ç½®AI APIå¯†é’¥ï¼ˆDeepSeekã€OpenAIæˆ–Geminiï¼‰ï¼š

```bash
# æ–¹å¼1: è®¾ç½®ç¯å¢ƒå˜é‡
export DEEPSEEK_API_KEY="your_api_key_here"
export AGENT_MODEL="deepseek-chat"
export DEEPSEEK_BASE_URL="https://api.deepseek.com"

# æ–¹å¼2: æˆ–ä½¿ç”¨config.pyä¸­çš„é…ç½®
```

#### æ­¥éª¤3: å¯åŠ¨FlaskæœåŠ¡å™¨

```bash
cd agent
python app.py
```

#### æ­¥éª¤4: è®¿é—®å‰ç«¯ç•Œé¢

åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ï¼š
```
http://localhost:5000
```

æˆ–

```
http://127.0.0.1:5000
```

### æ–¹æ³•2: ä½¿ç”¨Pythonå¯åŠ¨è„šæœ¬

```bash
cd agent
python start_agent.py
```

æ³¨æ„ï¼š`start_agent.py` æ˜¯å‘½ä»¤è¡Œäº¤äº’ç‰ˆæœ¬ï¼Œä¸æ˜¯Webç‰ˆæœ¬ã€‚

## ğŸ“ æ–‡ä»¶ç»“æ„

```
agent/
â”œâ”€â”€ app.py              # Flaskåç«¯æœåŠ¡å™¨
â”œâ”€â”€ index.html          # å‰ç«¯HTMLé¡µé¢
â”œâ”€â”€ style.css           # å‰ç«¯æ ·å¼æ–‡ä»¶
â”œâ”€â”€ script.js           # å‰ç«¯JavaScripté€»è¾‘
â”œâ”€â”€ book_agent.py       # Agentæ ¸å¿ƒé€»è¾‘
â””â”€â”€ requirements.txt    # Pythonä¾èµ–åŒ…
```

## ğŸ”§ é…ç½®è¯´æ˜

### åç«¯é…ç½®ï¼ˆapp.pyï¼‰

```python
# Flaskåº”ç”¨é…ç½®
app = Flask(__name__, static_folder='.', static_url_path='')
CORS(app)  # å¯ç”¨è·¨åŸŸæ”¯æŒ

# Agentå®ä¾‹
agent = BookRecommendationAgent()
```

### å‰ç«¯é…ç½®ï¼ˆscript.jsï¼‰

```javascript
// APIæœåŠ¡å™¨åœ°å€
const API_URL = 'http://127.0.0.1:5000';
```

å¦‚æœéœ€è¦ä¿®æ”¹ç«¯å£æˆ–åœ°å€ï¼Œéœ€è¦åŒæ—¶ä¿®æ”¹ï¼š
1. `app.py` ä¸­çš„ `app.run(port=5000)`
2. `script.js` ä¸­çš„ `API_URL`

## ğŸŒ APIç«¯ç‚¹

### 1. GET `/`
è¿”å›å‰ç«¯HTMLé¡µé¢

### 2. POST `/chat`
å¤„ç†ç”¨æˆ·èŠå¤©æ¶ˆæ¯

**è¯·æ±‚æ ¼å¼**:
```json
{
    "message": "æœç´¢ã€Šä¸‰ä½“ã€‹",
    "user_id": "user001"
}
```

**å“åº”æ ¼å¼**:
```json
{
    "response": "æ‰¾åˆ°äº†ã€Šä¸‰ä½“ã€‹çš„è¯¦ç»†ä¿¡æ¯..."
}
```

### 3. POST `/recommend`
è·å–å›¾ä¹¦æ¨è

**è¯·æ±‚æ ¼å¼**:
```json
{
    "book_title": "ä¸‰ä½“",
    "user_id": "user001"
}
```

**å“åº”æ ¼å¼**:
```json
{
    "recommendations": {
        "recommendations": [...],
        "recommendation_reasons": [...]
    }
}
```

## ğŸ¨ å‰ç«¯åŠŸèƒ½

### ä¸»è¦åŠŸèƒ½
- âœ… å®æ—¶èŠå¤©ç•Œé¢
- âœ… å›¾ä¹¦æœç´¢
- âœ… å›¾ä¹¦æ¨è
- âœ… ç”¨æˆ·äº¤äº’åé¦ˆ

### ç•Œé¢ç‰¹æ€§
- ç°ä»£åŒ–çš„èŠå¤©ç•Œé¢è®¾è®¡
- å“åº”å¼å¸ƒå±€
- å®æ—¶æ¶ˆæ¯æ˜¾ç¤º
- é”™è¯¯å¤„ç†æç¤º

## ğŸ› å¸¸è§é—®é¢˜

### é—®é¢˜1: æ— æ³•è®¿é—®å‰ç«¯é¡µé¢

**ç—‡çŠ¶**: æµè§ˆå™¨æ˜¾ç¤º"æ— æ³•è®¿é—®æ­¤ç½‘ç«™"

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®è®¤FlaskæœåŠ¡å™¨æ­£åœ¨è¿è¡Œ
2. æ£€æŸ¥ç«¯å£5000æ˜¯å¦è¢«å ç”¨
3. å°è¯•ä½¿ç”¨ `http://127.0.0.1:5000` è€Œä¸æ˜¯ `http://localhost:5000`

### é—®é¢˜2: APIè¯·æ±‚å¤±è´¥

**ç—‡çŠ¶**: å‰ç«¯æ˜¾ç¤ºè¿æ¥é”™è¯¯

**è§£å†³æ–¹æ¡ˆ**:
1. æ£€æŸ¥ `script.js` ä¸­çš„ `API_URL` æ˜¯å¦æ­£ç¡®
2. ç¡®è®¤FlaskæœåŠ¡å™¨çš„CORSå·²å¯ç”¨
3. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°çš„é”™è¯¯ä¿¡æ¯
4. æ£€æŸ¥åç«¯æ—¥å¿—æ˜¯å¦æœ‰é”™è¯¯

### é—®é¢˜3: ä¾èµ–åŒ…ç¼ºå¤±

**ç—‡çŠ¶**: å¯åŠ¨æ—¶æç¤ºæ¨¡å—æœªæ‰¾åˆ°

**è§£å†³æ–¹æ¡ˆ**:
```bash
pip install -r requirements.txt
```

### é—®é¢˜4: APIå¯†é’¥æœªè®¾ç½®

**ç—‡çŠ¶**: Agentæ— æ³•æ­£å¸¸å·¥ä½œ

**è§£å†³æ–¹æ¡ˆ**:
```bash
# è®¾ç½®ç¯å¢ƒå˜é‡
export DEEPSEEK_API_KEY="your_api_key"
# æˆ–ä¿®æ”¹ config.py
```

## ğŸ” è°ƒè¯•æŠ€å·§

### 1. æŸ¥çœ‹åç«¯æ—¥å¿—

Flaské»˜è®¤å¼€å¯debugæ¨¡å¼ï¼Œä¼šåœ¨æ§åˆ¶å°æ˜¾ç¤ºè¯¦ç»†é”™è¯¯ä¿¡æ¯ã€‚

### 2. æŸ¥çœ‹æµè§ˆå™¨æ§åˆ¶å°

æŒ‰ `F12` æ‰“å¼€å¼€å‘è€…å·¥å…·ï¼ŒæŸ¥çœ‹ï¼š
- Console: JavaScripté”™è¯¯
- Network: APIè¯·æ±‚çŠ¶æ€

### 3. æµ‹è¯•APIç«¯ç‚¹

ä½¿ç”¨curlæµ‹è¯•APIï¼š

```bash
# æµ‹è¯•èŠå¤©æ¥å£
curl -X POST http://localhost:5000/chat \
  -H "Content-Type: application/json" \
  -d '{"message": "æœç´¢ã€Šä¸‰ä½“ã€‹", "user_id": "test_user"}'
```

## ğŸ“ å¼€å‘å»ºè®®

### ä¿®æ”¹ç«¯å£

å¦‚æœéœ€è¦ä¿®æ”¹ç«¯å£ï¼Œç¼–è¾‘ `app.py`:

```python
if __name__ == '__main__':
    app.run(debug=True, port=8080)  # ä¿®æ”¹ä¸º8080ç«¯å£
```

åŒæ—¶ä¿®æ”¹ `script.js`:

```javascript
const API_URL = 'http://127.0.0.1:8080';  # å¯¹åº”ä¿®æ”¹
```

### æ·»åŠ æ–°åŠŸèƒ½

1. **æ·»åŠ æ–°çš„APIç«¯ç‚¹**ï¼šåœ¨ `app.py` ä¸­æ·»åŠ æ–°çš„è·¯ç”±
2. **ä¿®æ”¹å‰ç«¯ç•Œé¢**ï¼šç¼–è¾‘ `index.html` å’Œ `style.css`
3. **æ·»åŠ å‰ç«¯é€»è¾‘**ï¼šåœ¨ `script.js` ä¸­æ·»åŠ æ–°åŠŸèƒ½

## ğŸš€ ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²

### ä½¿ç”¨Gunicorn

```bash
pip install gunicorn
gunicorn -w 4 -b 0.0.0.0:5000 app:app
```

### ä½¿ç”¨Nginxåå‘ä»£ç†

é…ç½®Nginxå°†è¯·æ±‚è½¬å‘åˆ°Flaskåº”ç”¨ã€‚

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡é—®é¢˜ï¼Œè¯·ï¼š
1. æŸ¥çœ‹é”™è¯¯æ—¥å¿—
2. æ£€æŸ¥é…ç½®æ–‡ä»¶
3. å‚è€ƒé¡¹ç›®æ–‡æ¡£
4. æäº¤Issue

---

**æœ€åæ›´æ–°**: 2024å¹´12æœˆ

